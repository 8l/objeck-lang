use Gtk2;

bundle Default {
	class MyButton from GtkButton {
		New(title : String) {
			Parent(title);
		}

		method : public : Clicked() ~ Nil {
			"clicked..."->PrintLine();
		}
	}

	class HelloGtk {
		function : TestHandle(widget : GtkWidget) ~ Nil {
			"Hello Gtk2"->PrintLine();
			Appliction->MainQuit();
		}


		function : ButtonHandle(widget : GtkWidget) ~ Nil {
			button : GtkButton := widget;
			button->Clicked();
		}

		function : Main(args : String[]) ~ Nil {
			# callbacks
			delete_callback := Events->DeleteEvent(GtkWidget) ~ Nil;
			test_callback := TestHandle(GtkWidget) ~ Nil;
			button_callback := ButtonHandle(GtkWidget) ~ Nil;
	
			# create 
			button := MyButton->New("button 1");
			button2 := MyButton->New("button 2");

			hbox := GtkHBox->New(false, 0);
			hbox->PackStart(button->As(GtkWidget), true, true, 0);
			hbox->PackStart(button2->As(GtkWidget), true, true, 0);

			window := GtkWindow->New();
			window->SignalConnect(Signal->Destroy, test_callback);
			window->SetBorderWidth(35);
			window->SetTitle("Goodbye, World!");
			button->SignalConnect(Signal->Clicked, button_callback);
			window->Add(hbox->As(GtkWidget));
			
			# show
			button->Show();
			button2->Show();
			hbox->Show();			
			window->Show();
			Appliction->Main();
		}
	}
}
