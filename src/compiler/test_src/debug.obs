use ODBC;

bundle Default {
	class SqlTest {
		function : Main(args : String[]) ~ Nil {
			Run();
		}

		function : native : Run() ~ Nil {
			conn := Connection->New("test", "root", "helloworld");
			if(conn->IsOpen()) {
				ps := conn->CreateParameterStatement("insert into test.users2 values (?,?,?,?)");
				ps->SetInt(1, 7);
				ps->SetVarchar(2, "zpa");
				ps->SetVarchar(3, "bar");
				ps->SetVarchar(4, "foo+bar");
				ps->Update()->PrintLine();
#~
				result := ps->Select();
				if(result <> Nil) {
					i := 0;	
					while(result->Next()) {
						result->GetInt(1)->PrintLine();
						result->GetVarchar(2)->PrintLine();
						i += 1;
					};
					IO.Console->Print(i)->PrintLine(" row(s) selected");
					result->Close();
				};
~#
				ps->Close();
				conn->Close();
			};
		}
	}
}
