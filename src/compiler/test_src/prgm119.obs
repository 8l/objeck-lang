use FastCgi;

bundle Default {
	class FastCgiModule {
		function : Main(args : String[]) ~ Nil {
		}

		function : Request(req : Request, res : Response) ~ Nil {
			res->AddBody("<html>");
			res->AddBody("<form method=\"get\">");
			res->AddBody("First name: <input type=\"text\" name=\"fname\" /><br />");
			res->AddBody("Last name: <input type=\"text\" name=\"lname\" /><br />");
			res->AddBody("<input type=\"submit\" value=\"Submit\" />");
			res->AddBody("</form>"); 
			
			res->AddBody("<i>name="); 			
			name := req->GetParameter("lname");
			if(name <> Nil) {
				res->AddBody(name);
			};
			res->AddBody("</i><br/>"); 

			res->AddBody("<i>cookie value="); 			
			cookie := req->GetCookie("name3");
			if(cookie <> Nil) {
				res->AddBody(cookie);
			};

			cookie := req->GetCookie("name2");
			if(cookie <> Nil) {
				res->AddBody("; cookie value="); 			
				res->AddBody(cookie);
			};
			res->AddBody("</i>"); 

			res->AddBody("<p>"); 
			res->AddBody(req->GetClientAddress());
			res->AddBody("<p/>"); 

			res->AddBody("<html>");

			res->Submit();
		}
	}
}
