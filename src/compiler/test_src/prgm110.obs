use IO;
use ODBC;

bundle Default {
	class SqlTest {
		function : Main(args : String[]) ~ Nil {
			Run();
		}

		function : native : Run() ~ Nil {
			conn := Connection->New("test", "root", "");	
			if(conn <> Nil) {
				pstmt := conn->CreateParameterStatement("select * from test.new_table WHERE some_data=?");
				ts := Timestamp->New();
				ts->SetYear(2011);
				ts->SetMonth(10);
				ts->SetDay(26);
				ts->SetHours(20);
				ts->SetMinute(19);
				ts->SetSeconds(53);
				pstmt->SetTimestamp(1, ts);
				result := pstmt->Select();
				if(result <> Nil) {
					i := 0;	
					while(result->Next()) {
						result->GetInt(1)->PrintLine();
					};
					result->Close();
				};
#~
				pstmt := conn->CreateParameterStatement("UPDATE test.student SET first_name=?, credits=? WHERE id=?");
				pstmt->SetString(1, "randy");
				pstmt->SetInt(2, 512);
				pstmt->SetInt(3, 3);
				pstmt->Update()->PrintLine();
				pstmt->Close();
				conn->Update("UPDATE test.student SET last_name='dog' WHERE id=2")->PrintLine();
				result := conn->Select("select * from test.class ");
				if(result <> Nil) {
					i := 0;	
					while(result->Next()) {
						value := result->GetVarchar(5);
						value := result->GetVarchar("grad_code");
						if(result->IsNull() = false) {
							value->PrintLine();	
						};
						i += 1;
					};
					i->PrintLine();	
					result->Close();
				};
~#
				conn->Close();
			};
		}
	}
}
