use IO;

bundle Default {	
	class Hello {
		New() {
		}

		function : Main(args : System.String[]), Nil {
			Run();
		}
		function : native : Run(), Nil {
			reader := FileReader->New("../compiler/test_src/prgm1.obs");
			line_num := 0;
			while(reader->IsEOF() <> true) {
				line := reader->ReadString();
				line_num := line_num + 1;
									
				i := 0;	
				while(i < line->GetSize()) {		
					# skip whitespace
					while((line->GetChar(i) = ' ' | line->GetChar(i) = '\t') & i < line->GetSize()) {
						i := i + 1;
					};
					
					# word
					if(line->GetChar(i)->IsChar() = true) {
						string := "";
						while(line->GetChar(i)->IsChar() = true | line->GetChar(i) = '.') {
							string->Append(line->GetChar(i));
							i := i + 1;
						};
						"string '"->Print(); string->Print(); "'"->PrintLine();
					}
					# number
					else if(line->GetChar(i)->IsDigit() = true) {
						number := "";
						while(line->GetChar(i)->IsDigit() = true | line->GetChar(i) = '.') {
							number->Append(line->GetChar(i));
							i := i + 1;
						};
						"number '"->Print(); number->PrintLine(); "'"->PrintLine();
					}
					# other'c
					else {
						select(line->GetChar(i)) {
							label '(': {
								"opren"->PrintLine();
							}
							
							label ')': {
								"cpren"->PrintLine();
							}

							label '[': {
								"obrace"->PrintLine();
							}
							
							label ']': {
								"cbrace"->PrintLine();
							}			

							
							label '{': {
								"ocbrace"->PrintLine();
							}
				
							label '}': {
								"ccbrace"->PrintLine();
							}
							
							label '#': {
								"pound"->PrintLine();
							}
							
							other: {
								"'"->Print(); line->GetChar(i)->Print(); "'"->PrintLine();
							}
						};
						i := i + 1;
					};
				};
			};
			reader->Close();
		}
	}
}
